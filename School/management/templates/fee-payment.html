{% extends 'base.html' %}
{% load static %}
{%block content%}
    <!-- Page Area Start Here -->
    <div class="dashboard-page-one">
        {% include 'sidebar.html' %}
        <div class="dashboard-content-one">
            <!-- Breadcubs Area Start Here -->
            <div class="breadcrumbs-area">
                <h3>Fees</h3>
                <ul>
                    <li>
                        <a href="{% url 'homepage' %}">Home</a>
                    </li>
                    <li>
                        <a href="{% url 'fee payment student list' %}">Fee Payment Student List</a>
                    </li>
                    <li>Fee Payment</li>
                </ul>
            </div>
            <!-- Breadcubs Area End Here -->
            <!-- Group table area start here-->
            <div class="card height-auto">
                <div class="card-body">
                    <div class="heading-layout1">
                        <div class="item-title">
                            <h3>Fee Payment for {{student.student_id}}</h3>
                        </div>
                    </div>
                    {% if form.non_field_errors %}
                        {% for error in form.non_field_errors %}
                            <div class="alert alert-danger">{{ error }}</div>
                        {% endfor %}
                    {%endif%}
                    {% if form_tra.non_field_errors %}
                        {% for error in form_tra.non_field_errors %}
                            <div class="alert alert-danger">{{ error }}</div>
                        {% endfor %}
                    {%endif%}
                    <form action='' method="post" class="new-added-form" id="editForm" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.student_id.id_for_label }}">{{form.student_id.label}}</label>
                                    <input  type="text"  name="{{ form.student_id.name }}"  class="form-control"  id="{{ form.student_id.id_for_label }}" value="{{FeeData.student_id}}"  {% if form.student_id.field.required %} required {% endif %}  {% if form.student_id.field.widget.attrs.readonly %} readonly {% endif %}/>
                                    {% for error in form.student_id.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.class_id.id_for_label }}">{{form.class_id.label}}</label>
                                    <input  type="text"  name="{{ form.class_id.name }}"  class="form-control"  id="{{ form.class_id.id_for_label }}" value="{{FeeData.class_id}}_class" {% if form.class_id.field.required %} required {% endif %}  {% if form.class_id.field.widget.attrs.readonly %} readonly {% endif %}/>
                                    {% for error in form.class_id.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.phone_number.id_for_label }}">{{form.phone_number.label}}</label>
                                    <input  type="text"  name="{{ form.phone_number.name }}"  class="form-control"  id="{{ form.phone_number.id_for_label }}" value="{{FeeData.phone_number}}" {% if form.phone_number.field.required %} required {% endif %}  {% if form.phone_number.field.widget.attrs.readonly %} readonly {% endif %}/>
                                    {% for error in form.phone_number.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.monthly_fee.id_for_label }}">{{form.monthly_fee.label}}</label>
                                    {{ form.monthly_fee }}
                                    {% for error in form.monthly_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.admission_fee.id_for_label }}">{{form.admission_fee.label}}</label>
                                    {{ form.admission_fee }}
                                    {% for error in form.admission_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.first_quarter_exam_fee.id_for_label }}">{{form.first_quarter_exam_fee.label}}</label>
                                    {{ form.first_quarter_exam_fee }}
                                    {% for error in form.first_quarter_exam_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.first_quarter_exam_fee.id_for_label }}">{{form.first_quarter_exam_fee.label}}</label>
                                    {{ form.first_quarter_exam_fee }}
                                    {% for error in form.first_quarter_exam_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.half_year_exam_fee.id_for_label }}">{{form.half_year_exam_fee.label}}</label>
                                    {{ form.half_year_exam_fee }}
                                    {% for error in form.half_year_exam_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.second_quarter_exam_fee.id_for_label }}">{{form.second_quarter_exam_fee.label}}</label>
                                    {{ form.second_quarter_exam_fee }}
                                    {% for error in form.second_quarter_exam_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.annual_exam_fee.id_for_label }}">{{form.annual_exam_fee.label}}</label>
                                    {{ form.annual_exam_fee }}
                                    {% for error in form.annual_exam_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.board_reg_fee.id_for_label }}">{{form.board_reg_fee.label}}</label>
                                    {{ form.board_reg_fee }}
                                    {% for error in form.board_reg_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.board_fee.id_for_label }}">{{form.board_fee.label}}</label>
                                    {{ form.board_fee }}
                                    {% for error in form.board_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.admit_card_fee.id_for_label }}">{{form.admit_card_fee.label}}</label>
                                    {{ form.admit_card_fee }}
                                    {% for error in form.admit_card_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.practical_1_fee.id_for_label }}">{{form.practical_1_fee.label}}</label>
                                    {{ form.practical_1_fee }}
                                    {% for error in form.practical_1_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.practical_1_fee.id_for_label }}">{{form.practical_2_fee.label}}</label>
                                    {{ form.practical_2_fee }}
                                    {% for error in form.practical_2_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.practical_1_fee.id_for_label }}">{{form.practical_3_fee.label}}</label>
                                    {{ form.practical_3_fee }}
                                    {% for error in form.practical_3_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form.practical_4_fee.id_for_label }}">{{form.practical_4_fee.label}}</label>
                                    {{ form.practical_4_fee }}
                                    {% for error in form.practical_4_fee.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form_tra.transaction_date.id_for_label }}">{{form_tra.transaction_date.label}}</label>
                                    {{ form_tra.transaction_date }}
                                    {% for error in form_tra.transaction_date.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form_tra.transaction_type.id_for_label }}">{{form_tra.transaction_type.label}}</label>
                                    {{ form_tra.transaction_type }}
                                    {% for error in form_tra.transaction_type.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form_tra.payment_mode.id_for_label }}">{{form_tra.payment_mode.label}}</label>
                                    {{ form_tra.payment_mode }}
                                    {% for error in form_tra.payment_mode.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="{{form_tra.reference_no.id_for_label }}">{{form_tra.reference_no.label}}</label>
                                    {{ form_tra.reference_no }}
                                    {% for error in form_tra.reference_no.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="{{form_tra.remarks.id_for_label }}">{{form_tra.remarks.label}}</label>
                                    {{ form_tra.remarks }}
                                    {% for error in form_tra.remarks.errors%}
                                    <small class="text-danger">{{error}}</small>
                                    {%endfor%}
                                </div>
                            </div>
                            {{ form_tra.amount_paid }}
                        </div>
                        <div class="form-group mg-t-8 text-right">
                            <button type="submit" class="btn-fill-lg btn-gradient-yellow btn-hover-bluedark mr-3">Pay Fee Now</button>
                            <button type="reset" class="btn-fill-lg bg-blue-dark btn-hover-yellow">Reset</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- Group table area end here-->
            {% if messages %}
                {% for message in messages %}
                    {% if message.tags %}
                    <div class="alert alert-success {{ message.tags }}" role="alert">{{ message }}</div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
    </div>
{%endblock%}
{%block js%}
<script>
    $(document).ready(function(){
        var class_id = $("#id_class_id").val();
        if (class_id == '9th_class' || class_id == '11th_class') {
            $("#id_board_fee, #id_practical_1_fee, #id_practical_2_fee, #id_practical_3_fee, #id_practical_4_fee, #admit_card_fee").closest(".col-md-6").hide();
            console.log('if worked');
        }
        else if (class_id == '10th_class' || class_id == '12th_class'){
            $("#id_board_reg_fee").closest(".col-md-6").hide();
            console.log('else if worked');
        }else{
            $("#id_board_reg_fee, #id_board_fee, #id_practical_1_fee, #id_practical_2_fee, #id_practical_3_fee, #id_practical_4_fee, #admit_card_fee").closest(".col-md-6").hide();
            console.log('else worked');
        }
        $('#editForm').on('submit', function(e) {
            var feeFields = [
                '#id_monthly_fee', '#id_admission_fee', '#id_first_quarter_exam_fee', '#id_half_year_exam_fee',
                '#id_second_quarter_exam_fee', '#id_annual_exam_fee', '#id_board_reg_fee', '#id_board_fee',
                '#id_admit_card_fee', '#id_practical_1_fee', '#id_practical_2_fee', '#id_practical_3_fee', '#id_practical_4_fee'
            ];
            var amount_paid = 0;
            $.each(feeFields, function(index, field) {
                var feeValue = $(field).val();
                if (feeValue === "" || feeValue === null) {
                    feeValue = 0;
                }
                amount_paid += parseFloat(feeValue);
            });
            console.log("Total Amount Paid: " + amount_paid);
            $('#id_amount_paid').val(amount_paid);
        })
    })
</script>
{%endblock%}